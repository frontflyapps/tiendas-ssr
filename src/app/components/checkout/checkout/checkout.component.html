<!-- <div *ngIf="this.loadingSearch" class="loading-shade-full">
  <mat-spinner *ngIf="this.loadingSearch" diameter="60" color="primary"></mat-spinner>
</div> -->
<div
  *ngIf="!loading"
  style="height: 80vh"
  class="d-flex justify-content-center align-items-center"
  data-id="501ef74f"
>
  <mat-spinner *ngIf="!loading" diameter="60" color="primary" data-id="d2349fd2"></mat-spinner>
</div>
<div class="container-checkout" ngClass.lt-md="px-2" *ngIf="loading" data-id="6fb02895">
  <div class="checkout sec-padding" data-id="2b72e3cf">
    <div
      *ngIf="loadingPayment"
      class="w-100 my-3 d-flex flex-column justify-content-center align-items-center"
      style="height: 400px"
      data-id="bcc7eddb"
    >
      <div class="loading-dots mat-title" data-id="1f579843">
        {{ 'Procesando los datos' | translate }}
      </div>
      <div class="loading-dots mat-subheading-1" data-id="e0791a38">
        {{ 'Cargando pasarela de pago' | translate }}...
      </div>
    </div>

    <div
      *ngIf="!loadingPayment && businessConfig"
      class="billing-details flex-sh-100 flex-sh-md-50 flex-sh-50 flex-sh-md-initial"
      ngClass.gt-sm="pr-5"
      ngClass.sm="pr-2"
      ngClass.xs="pr-0"
      data-id="7d7c65da"
    >
      <mat-horizontal-stepper
        #stepper
        [linear]="'true'"
        labelPosition="bottom"
        class="billing-details"
        data-id="8bc4be4b"
      >
        <mat-step
          *ngIf="
            businessConfig?.shippingType == 'normal' || businessConfig?.shippingType == 'fixed'
          "
          [completed]="!noGateway && !form.get('ShippingBusinessId').invalid"
          data-id="a7abcde8"
        >
          <ng-template matStepLabel data-id="9dbef46c">{{
            'Datos de pago' | translate
          }}</ng-template>
          <p class="my-2" *ngIf="form.get('paymentType').value" data-id="a4c45fd9">
            <strong data-id="6af79e09">{{
              'Seleccione una pasarela para efectuar el pago' | translate
            }}</strong>
          </p>

          <div class="p-2" data-id="d75cbed2">
            <!-- METODOS DE PAGO -->
            <div class="paymentFinal" id="payment-method" data-id="fcfcbdd9">
              <!--  fxLayout.lt-sm="column"  -->
              <mat-radio-group
                [formControl]="form.get('paymentType')"
                *ngIf="!onMarket"
                class="d-flex justify-content-center align-items-start transpilerClass-fxLayoutGap-e4e9d1"
                data-id="fa2d4647"
              >
                <ng-container *ngFor="let pay of payments" data-id="db7419d6">
                  <ng-container
                    *ngIf="
                      this.onlyCubanPeople &&
                      cart?.market === 'national' &&
                      pay?.market === 'national'
                    "
                    data-id="bb48407a"
                  >
                    <!-- fxFlex="50%" fxFlex.lt-sm="100%" -->
                    <mat-radio-button
                      [value]="pay.id"
                      class="radio-button-national"
                      data-id="4f324005"
                    >
                      <!-- {{this.onlyCubanPeople}} - {{cart?.market}}-->
                      <div
                        [ngClass]="{ 'payment-active': form.get('paymentType').value === pay.id }"
                        class="pay-method-container d-flex justify-content-start align-items-center"
                        data-id="78c2a40b"
                      >
                        <img [src]="pay.logo" class="pay-method-icon" data-id="58bc9070" />
                        <span class="mat-body-2 uppercase pay-method-name" data-id="6bac848b">
                          <!-- {{ pay.name }}-->
                        </span>
                      </div>
                    </mat-radio-button>
                  </ng-container>

                  <ng-container
                    *ngIf="
                      this.onlyCubanPeople &&
                      cart?.market === 'international' &&
                      pay?.market === 'international'
                    "
                    data-id="57f6b560"
                  >
                    <mat-radio-button
                      *ngIf="this.onlyCubanPeople && cart?.market === 'international'"
                      [value]="pay.id"
                      class="radio-button-international"
                      data-id="129a7e9f"
                    >
                      <div
                        [ngClass]="{ 'payment-active': form.get('paymentType').value === pay.id }"
                        class="pay-method-container d-flex justify-content-start align-items-center"
                        data-id="34a2c94d"
                      >
                        <img [src]="pay.logo" class="pay-method-icon" data-id="269bf38e" />
                        <span class="mat-body-2 uppercase pay-method-name" data-id="0d6e9879">
                          <!-- {{ pay.name }} -->
                        </span>
                      </div>
                    </mat-radio-button>
                  </ng-container>
                </ng-container>
              </mat-radio-group>
              <mat-radio-group
                [formControl]="form.get('paymentType')"
                *ngIf="onMarket"
                class="d-flex justify-content-center align-items-start transpilerClass-fxLayoutGap-858bc1"
                data-id="9050aae5"
              >
                <ng-container *ngFor="let pay of payments" data-id="93da47d8">
                  <ng-container data-id="8fcb601b">
                    <mat-radio-button
                      *ngIf="pay.market === 'international'"
                      [value]="pay.id"
                      class="radio-button-international"
                      data-id="672e988c"
                    >
                      <div
                        [ngClass]="{ 'payment-active': form.get('paymentType').value === pay.id }"
                        class="pay-method-container d-flex justify-content-start align-items-center"
                        data-id="30613a5a"
                      >
                        <img [src]="pay.logo" class="pay-method-icon" data-id="49dec411" />
                        <span class="mat-body-2 uppercase pay-method-name" data-id="80ec60f1">
                          <!-- {{ pay.name }} -->
                        </span>
                      </div>
                    </mat-radio-button>
                  </ng-container>
                </ng-container>
              </mat-radio-group>
            </div>
          </div>
          <!-- ============================================ -->
          <!-- SELECTOR DE MONEDAS -->
          <!-- ============================================ -->
          <ng-container
            *ngIf="
              !loadingPayment &&
              (form.controls['paymentType'].value === 'visa' ||
                form.controls['paymentType'].value === 'express' ||
                form.controls['paymentType'].value === 'masterCard' ||
                form.controls['paymentType'].value === 'dinners-club-internacional' ||
                form.controls['paymentType'].value === 'jcb' ||
                form.controls['paymentType'].value === 'maestro' ||
                form.controls['paymentType'].value === 'electron' ||
                form.controls['paymentType'].value === 'tarjeta-virtual' ||
                form.controls['paymentType'].value === 'bizum' ||
                form.controls['paymentType'].value === 'iupay' ||
                form.controls['paymentType'].value === 'discover-global' ||
                multiTransfermovil)
            "
            data-id="3ef286fd"
          >
            <ng-container *ngIf="!loadingPayment" data-id="b9c0b33c">
              <p
                class="mat-body-2 my-2"
                style="text-transform: uppercase"
                *ngIf="
                  !multiTransfermovil ||
                  (multiTransfermovil && form.get('paymentType').value === 'transfermovil')
                "
                data-id="c9eabb93"
              >
                {{ 'Selecciones moneda para realizar su pago' | translate }}
              </p>
              <div class="d-flex" data-id="18d24997">
                <mat-form-field
                  appearance="outline"
                  *ngIf="!multiTransfermovil"
                  class="flex-sh-50 flex-sh-md-100"
                  data-id="378d353b"
                >
                  <mat-label data-id="b2e096b2">{{ 'Currency' | translate }}</mat-label>
                  <mat-select
                    [formControl]="form.controls['currency']"
                    placeholder="{{ 'Currency' | translate }}"
                    (selectionChange)="form.controls['ShippingBusinessId'].setValue(null)"
                    data-id="d07fcc87"
                  >
                    <ng-container *ngFor="let currency of currencies" data-id="bd6afda9">
                      <mat-option
                        *ngIf="
                          !(currency === 'EUR' && form.get('paymentType').value === 'transfermovil')
                        "
                        [value]="currency"
                        data-id="4c700cde"
                      >
                        <span class="mat-body-2" data-id="374b664b">
                          {{ currency }}
                        </span>
                      </mat-option>
                    </ng-container>
                  </mat-select>
                </mat-form-field>
                <mat-form-field
                  appearance="outline"
                  *ngIf="multiTransfermovil && form.get('paymentType').value === 'transfermovil'"
                  class="flex-sh-50 flex-sh-md-100"
                  data-id="3efb225e"
                >
                  <mat-label data-id="9cb4f052">{{ 'Currency' | translate }}</mat-label>
                  <mat-select
                    [formControl]="form.controls['currency']"
                    placeholder="{{ 'Currency' | translate }}"
                    (selectionChange)="form.controls['ShippingBusinessId'].setValue(null)"
                    data-id="4237eeab"
                  >
                    <ng-container *ngFor="let currency of currenciesTuUse" data-id="d7e4e33a">
                      <mat-option
                        *ngIf="form.get('paymentType').value === 'transfermovil'"
                        [value]="currency.value"
                        data-id="756d144f"
                      >
                        <span class="mat-body-2" data-id="50c6f7a0">
                          {{ currency.name }}
                        </span>
                      </mat-option>
                    </ng-container>
                  </mat-select>
                </mat-form-field>
              </div>
            </ng-container>
          </ng-container>
          <!--------- SHIPPING DETAILS ----------->
          <ng-container
            *ngIf="form.controls['currency'].value && form.get('paymentType').value"
            data-id="e8553bd0"
          >
            <p
              class="my-3"
              *ngIf="
                form.get('paymentType').value?.length !== 1 &&
                form.get('paymentType').value?.length !== 2 &&
                form.get('paymentType').value?.length !== 3 &&
                form.get('paymentType').value?.length !== 4
              "
              data-id="8dc80cda"
            >
              <strong data-id="0a00c8f6">{{ 'Shipping Details' | translate }}</strong>
            </p>

            <div class="d-flex justify-content-start align-items-center" data-id="4818a84f">
              <mat-checkbox
                ngClass.xs="mb-2"
                style="margin-bottom: 12px"
                (change)="onChangeShippingRequired($event)"
                *ngIf="
                  form.get('paymentType').value?.length !== 1 &&
                  form.get('paymentType').value?.length !== 2 &&
                  form.get('paymentType').value?.length !== 3 &&
                  form.get('paymentType').value?.length !== 4
                "
                [formControl]="form.get('shippingRequired')"
                class="order-xs-1 order-sm-1"
                data-id="dafbf8e4"
              >
                <span class="mat-body-2" data-id="a6a7f241">{{
                  'Solicitar envío a domicilio' | translate
                }}</span>
              </mat-checkbox>
            </div>

            <!--SELECTORE DE PROVINCIA Y MUNICIPIOS-->
            <div
              *ngIf="
                showShipping &&
                form.get('paymentType').value?.length !== 1 &&
                form.get('paymentType').value?.length !== 2 &&
                form.get('paymentType').value?.length !== 3 &&
                form.get('paymentType').value?.length !== 4
              "
              class="d-flex justify-content-between align-items-center"
              data-id="92998525"
            >
              <mat-form-field
                appearance="outline"
                class="flex-sh-50 flex-sh-md-100"
                data-id="3eabfbb8"
              >
                <mat-label data-id="bfe4b2f0">{{ 'Provincia' | translate }}</mat-label>
                <mat-select
                  (selectionChange)="onSelectProvince($event.value)"
                  [compareWith]="compareById"
                  [formControl]="form.controls['ProvinceId']"
                  placeholder="{{ 'Nombre de la provincia' | translate }}"
                  type="text"
                  data-id="4f83c348"
                >
                  <mat-option
                    *ngFor="let province of allProvinces"
                    [value]="province.id"
                    data-id="522c679e"
                  >
                    {{ province.name }}
                  </mat-option>
                </mat-select>
                <mat-error
                  *ngIf="form.controls['ProvinceId'].hasError('required')"
                  data-id="0e304c17"
                >
                  {{ 'Provincia' | translate }}
                  <strong data-id="679da023">{{ 'is required' | translate }}</strong>
                </mat-error>
              </mat-form-field>

              <mat-form-field
                appearance="outline"
                class="flex-sh-50 flex-sh-md-100"
                data-id="81070604"
              >
                <mat-label data-id="41345229">{{ 'Municipio' | translate }}</mat-label>
                <mat-select
                  (selectionChange)="form.controls['ShippingBusinessId'].setValue(null)"
                  [compareWith]="compareById"
                  [formControl]="form.controls['MunicipalityId']"
                  placeholder="{{ 'Nombre del Municipio' | translate }}"
                  type="text"
                  data-id="72ea82ff"
                >
                  <mat-option
                    *ngFor="let municipio of municipalities"
                    [value]="municipio.id"
                    data-id="d8e7f152"
                  >
                    {{ municipio.name }}
                  </mat-option>
                </mat-select>
                <mat-error
                  *ngIf="form.controls['MunicipalityId'].hasError('required')"
                  data-id="d2467c30"
                >
                  {{ 'Municipio' | translate }}
                  <strong data-id="8733031b">{{ 'is required' | translate }}</strong>
                </mat-error>
              </mat-form-field>
            </div>

            <p class="p-3" *ngIf="shippingIsRequired" data-id="3f25148c">
              *{{ 'El envío es requerido para comprar en este negocio.' | translate }}
            </p>
            <div
              *ngIf="showShipping"
              class="w-100 mb-3 shippingList-box d-flex flex-column justify-content-start align-items-start"
              data-id="13b0c5ae"
            >
              <!------Load Shipping Options------>
              <div
                *ngIf="loadingShipping"
                class="loading-shade"
                style="height: 100%"
                data-id="7fedc7e9"
              >
                <mat-spinner *ngIf="inLoading" [diameter]="40" data-id="b74ad008"></mat-spinner>
              </div>

              <div
                *ngIf="buscoShipping && !shippingData.length"
                class="d-flex justify-content-between align-items-center"
                data-id="485cfa7d"
              >
                <mat-icon
                  style="min-width: 60px; width: 60px; height: 60px; font-size: 47px"
                  color="accent"
                  data-id="54d9018a"
                  >info</mat-icon
                >
                <h1 data-id="48c95aea">
                  {{ 'Lo sentimos! No hay envíos disponibles para el municipio:' | translate }}
                  <b data-id="e5401d64">{{ selectedMunicipality?.name }}</b>
                </h1>
              </div>

              <div
                class="px-2 pt-2 w-100 d-flex justify-content-start align-items-center"
                style="background-color: #e3e3e3; border-radius: 8px"
                *ngIf="buscoShipping && !shippingData.length"
                data-id="9659288e"
              >
                <mat-icon
                  style="min-width: 40px; width: 40px; height: 40px; font-size: 30px"
                  color="accent"
                  data-id="e6bab652"
                  >help</mat-icon
                >
                <h5 data-id="70d4ca21">
                  {{
                    'Desmarque la opción de solicitar envío para poder continuar con la compra.'
                      | translate
                  }}
                </h5>
              </div>

              <!--------------------------------->

              <!------Shipping List------->
              <mat-radio-group
                [formControl]="form.get('ShippingBusinessId')"
                class="w-100"
                (change)="onShippingSelected($event)"
                data-id="8d4ec6e0"
              >
                <div
                  *ngFor="let shipping of shippingData"
                  class="mb-2 d-flex justify-content-start align-items-center"
                  data-id="f065ba46"
                >
                  <mat-radio-button
                    class="w-100 d-flex justify-content-center align-items-center flex-sh-100"
                    matTooltip="{{ shipping?.Business?.name }}"
                    style="height: 50px"
                    [value]="shipping"
                    data-id="72632b7e"
                  >
                    <div
                      class="d-flex justify-content-between align-items-center flex-sh-100"
                      data-id="d12b49ce"
                    >
                      <div
                        class="d-flex justify-content-start align-items-center flex-sh-0 flex-sh-md-70"
                        data-id="e33b463b"
                      >
                        <div
                          class="d-flex flex-column justify-content-start align-items-start"
                          data-id="f02715e7"
                        >
                          <span class="ml-2 mat-caption" style="color: black" data-id="1caeab1b">
                            {{ shipping.shippingItems[0]?.Shipping?.Province?.name }},
                            {{ shipping.shippingItems[0]?.Shipping?.Municipality?.name }}
                          </span>
                          <div
                            class="d-flex d-sm-flex flex-column flex-sm-column"
                            data-id="67922c79"
                          >
                            <span class="ml-2 mat-caption" style="color: black" data-id="d5f731e0">
                              {{ 'Entrega a través de ' | translate }}
                            </span>
                            <span class="ml-2 mat-caption" style="color: black" data-id="e2206030">
                              ({{ shipping?.Business?.name }})
                            </span>
                          </div>
                        </div>
                      </div>
                      <span
                        class="taxAmount flex-sh-md-30"
                        style="font-size: 20px"
                        data-id="679a8d36"
                      >
                        {{
                          shipping.totalPrice || 0
                            | currencyProduct: shipping.shippingItems[0]?.Shipping?.currency
                        }}
                      </span>
                    </div>
                  </mat-radio-button>
                </div>
              </mat-radio-group>
              <!--------------------------->
            </div>
          </ng-container>
          <ng-container *ngIf="!cart?.hasShippingBusiness" data-id="4221aadb">
            <p class="tex-align-center p-4" data-id="1f9dd238">
              {{ 'No hay envío para estos productos' | translate }}
            </p>
          </ng-container>
          <!--          <ng-container >-->
          <h1 *ngIf="noGateway" class="tex-align-center p-4 color-red-500" data-id="3a975b3c">
            {{ 'Este negocio no tiene método de pago permitido' }}
          </h1>
          <!--          </ng-container>-->
          <!---------------------->

          <div
            class="actions-buttons d-flex justify-content-between align-items-start flex-sh-NaN"
            data-id="6a2d58c0"
          >
            <button
              [routerLink]="['/products/search']"
              mat-stroked-button
              matStepperPrevious
              data-id="f3a49e49"
            >
              {{ 'Cancelar' | translate }}
            </button>

            <button
              id="buttonFirstStep"
              color="primary"
              mat-raised-button
              matStepperNext
              [disabled]="
                noGateway ||
                form.get('ShippingBusinessId').invalid ||
                (shippingIsRequired && !form.get('ShippingBusinessId').value) ||
                form.get('paymentType').value?.length == 1 ||
                form.get('paymentType').value?.length == 2 ||
                form.get('paymentType').value?.length == 3 ||
                form.get('paymentType').value?.length == 4
              "
              data-id="ea08006a"
            >
              {{ 'Continuar' | translate }}
            </button>
          </div>
        </mat-step>
        <mat-step [completed]="!form.invalid" data-id="c7ba7004">
          <ng-template matStepLabel data-id="a32df77f">{{
            'Destinatario' | translate
          }}</ng-template>

          <div *ngIf="!loadingPayment" class="header-title" data-id="6969e0b8">
            <h3 class="grey-800" ngClass.gt-sm="h2" ngClass.xs="h4" data-id="0a70d0df">
              {{ 'Billing Details' | translate }}
            </h3>
          </div>

          <div
            *ngIf="!loadingPayment"
            [formGroup]="form"
            class="d-flex justify-content-start align-items-start"
            data-id="b73ce65c"
          >
            <div
              ngClass.sm="mt-2"
              ngClass.xs="mt-2"
              class="d-flex flex-column justify-content-start align-items-stretch flex-sh-100"
              data-id="73b33e27"
            >
              <div
                class="d-flex d-xs-flex d-sm-flex flex-xs-column flex-sm-column justify-content-between align-items-center justify-content-xs-start justify-content-sm-start align-items-xs-end align-items-sm-end transpilerClass-fxLayoutGap-ebcac9"
                data-id="98ccd8aa"
              >
                <p
                  class="mat-body-2 my-2"
                  style="text-transform: uppercase"
                  title="{{ 'Información del cliente que obtendrá los productos' | translate }}"
                  data-id="44160c35"
                >
                  {{ 'Datos personales del destinatario' | translate }}
                  <mat-icon
                    class="iconHelp"
                    matTooltip="{{
                      'Información del cliente que obtendrá los productos' | translate
                    }}"
                    style="cursor: pointer"
                    data-id="98aebb35"
                    >help
                  </mat-icon>
                </p>

                <div
                  class="d-flex flex-column d-xs-flex d-sm-flex flex-xs-column flex-sm-column d-md-flex flex-md-column"
                  data-id="d6b1c6a1"
                >
                  <button
                    aria-label="Example icon-button with a menu"
                    color="primary"
                    mat-stroked-button
                    class="mb-3"
                    ngClass.xs="mb-3"
                    (click)="fillLoggedInfo()"
                    data-id="029f9e5a"
                  >
                    <mat-icon data-id="b58d5b2a">book</mat-icon>
                    {{ 'Llenar con mis datos' | translate }}
                  </button>

                  <button
                    [matMenuTriggerFor]="menuContacts"
                    aria-label="Example icon-button with a menu"
                    color="primary"
                    mat-stroked-button
                    ngClass.xs="mb-3"
                    data-id="b43a83af"
                  >
                    <mat-icon data-id="4fda7a0f">book</mat-icon>
                    {{ 'Contactos guardados' | translate }}
                  </button>
                  <mat-menu #menuContacts="matMenu" data-id="b06f99ce">
                    <ng-container
                      *ngFor="let contact of contactsService.allContacts"
                      data-id="2850e583"
                    >
                      <button (click)="onSelectContact(contact)" mat-menu-item data-id="3a63d35c">
                        <mat-icon *ngIf="!contact.selected" data-id="8bbae5a8"
                          >person_outline</mat-icon
                        >
                        <mat-icon
                          *ngIf="contact.selected"
                          matTooltip="{{ 'Contacto predeterminado' | translate }}"
                          data-id="65efa229"
                          >star</mat-icon
                        >
                        <span data-id="ec330296"
                          >{{ contact.name }}&nbsp;{{ contact.lastName }}</span
                        >
                      </button>
                    </ng-container>
                    <button
                      (click)="onAddContact()"
                      mat-menu-item
                      style="border-top: 4px solid #e7e4e4"
                      data-id="1ffcaf96"
                    >
                      <mat-icon data-id="23b91cc2">playlist_add</mat-icon>
                      <span data-id="1c5c4622">{{ 'Agregar / Editar' | translate }}</span>
                    </button>
                  </mat-menu>
                </div>
              </div>

              <div class="d-flex justify-content-between align-items-center" data-id="22149be7">
                <mat-form-field
                  appearance="outline"
                  class="flex-sh-100 flex-sh-md-50 flex-sh-50 flex-sh-md-initial"
                  data-id="ef238906"
                >
                  <mat-label data-id="a228caa3">{{ 'Name' | translate }}</mat-label>
                  <input
                    [formControl]="this.form.controls['name']"
                    matInput
                    placeholder="{{ 'Name' | translate }}"
                    required
                    (keypress)="utilsService.keyPressAlpha($event)"
                    data-id="c5ad1ab0"
                  />
                  <mat-error *ngIf="form.controls['name'].hasError('required')" data-id="fe4c0c52">
                    {{ 'Name' | translate }}
                    <strong data-id="d795bef3">{{ 'is required' | translate }}</strong>
                  </mat-error>
                </mat-form-field>
                <mat-form-field
                  appearance="outline"
                  class="flex-sh-100 flex-sh-md-50 flex-sh-50 flex-sh-md-initial"
                  data-id="787470e0"
                >
                  <mat-label data-id="163f46d6">{{ 'Lastname' | translate }}</mat-label>
                  <input
                    [formControl]="this.form.controls['lastName']"
                    matInput
                    placeholder="{{ 'Lastname' | translate }}"
                    required
                    (keypress)="utilsService.keyPressAlpha($event)"
                    data-id="c6dc01af"
                  />
                  <mat-error
                    *ngIf="form.controls['lastName'].hasError('required')"
                    data-id="1b9c2e34"
                  >
                    {{ 'Lastname' | translate }}
                    <strong data-id="d8990a90">{{ 'is required' | translate }}</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <mat-form-field appearance="outline" data-id="a750967b">
                <mat-label data-id="e456aac4">{{ 'Email' | translate }}</mat-label>
                <input
                  [formControl]="this.form.controls['email']"
                  (keypress)="utilsService.keyLettersNumberForEmail($event)"
                  matInput
                  placeholder="{{
                    'Mail for order confirmation and customer contact ' | translate
                  }}"
                  required
                  type="email"
                  data-id="10ccb7df"
                />
                <mat-error *ngIf="form.controls['email'].hasError('required')" data-id="280fd7aa">
                  {{ 'Email' | translate }}
                  <strong data-id="20f922c0">{{ 'is required' | translate }}</strong>
                </mat-error>
                <mat-error *ngIf="form.controls['email'].hasError('pattern')" data-id="11ff3393">
                  {{ 'Email' | translate }}
                  <strong data-id="29dbc6d4">{{ 'incorrect' | translate }}</strong>
                </mat-error>
              </mat-form-field>

              <p
                class="mat-body-2 my-2"
                style="text-transform: uppercase"
                *ngIf="canBeDelivery || showAddress"
                title="{{ 'Datos adicionales del cliente que obtendrá los productos' | translate }}"
                data-id="8097b9cd"
              >
                {{ 'Datos del destinatario' | translate }}
                <mat-icon
                  class="iconHelp"
                  *ngIf="canBeDelivery || showAddress"
                  matTooltip="{{
                    'Datos adicionales del cliente que obtendrá los productos' | translate
                  }}"
                  style="cursor: pointer"
                  data-id="d990f409"
                  >help
                </mat-icon>
              </p>

              <!-- SOLO PARA CUBANOS -->
              <ng-container
                *ngIf="onlyCubanPeople && (canBeDelivery || showAddress)"
                data-id="2e4bbaff"
              >
                <div class="d-flex justify-content-between align-items-center" data-id="19022e77">
                  <mat-form-field
                    appearance="outline"
                    class="flex-sh-50 flex-sh-md-100"
                    data-id="afcd19c8"
                  >
                    <mat-label data-id="97869c3d">{{ 'Provincia' | translate }}</mat-label>
                    <mat-select
                      (selectionChange)="onSelectProvince($event.value)"
                      [compareWith]="compareById"
                      [formControl]="form.controls['ProvinceId']"
                      [disabled]="form.get('shippingRequired').value"
                      placeholder="{{ 'Nombre de la provincia' | translate }}"
                      type="text"
                      [required]="showAddress"
                      data-id="960e8186"
                    >
                      <mat-option
                        *ngFor="let province of allProvinces"
                        [value]="province.id"
                        data-id="0e5240b4"
                      >
                        {{ province.name }}
                      </mat-option>
                    </mat-select>
                    <mat-error
                      *ngIf="form.controls['ProvinceId'].hasError('required')"
                      data-id="a56f97b6"
                    >
                      {{ 'Provincia' | translate }}
                      <strong data-id="9e4e8790">{{ 'is required' | translate }}</strong>
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field
                    appearance="outline"
                    class="flex-sh-50 flex-sh-md-100"
                    data-id="c3d0719f"
                  >
                    <mat-label data-id="2c7a8e81">{{ 'Municipio' | translate }}</mat-label>
                    <mat-select
                      (selectionChange)="form.controls['ShippingBusinessId'].setValue(null)"
                      [compareWith]="compareById"
                      [formControl]="form.controls['MunicipalityId']"
                      [disabled]="form.get('shippingRequired').value"
                      placeholder="{{ 'Nombre del Municipio' | translate }}"
                      type="text"
                      [required]="showAddress"
                      data-id="d83a80a5"
                    >
                      <mat-option
                        *ngFor="let municipio of municipalities"
                        [value]="municipio.id"
                        data-id="db370fc5"
                      >
                        {{ municipio.name }}
                      </mat-option>
                    </mat-select>
                    <mat-error
                      *ngIf="form.controls['MunicipalityId'].hasError('required')"
                      data-id="b478d46f"
                    >
                      {{ 'Municipio' | translate }}
                      <strong data-id="6615c596">{{ 'is required' | translate }}</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <mat-error
                  *ngIf="form.controls['ProvinceId'].hasError('forbiddenProvince')"
                  data-id="bd9b0601"
                >
                  {{
                    '**Esta localización no coincide con la del envío seleccionado.**' | translate
                  }}
                </mat-error>
              </ng-container>

              <!-- SOLO PARA EXTRANJEROS -->
              <ng-container
                *ngIf="!onlyCubanPeople && (canBeDelivery || showAddress)"
                data-id="b31316cb"
              >
                <p class="mat-body-2 my-2" style="text-transform: uppercase" data-id="5fc032ce">
                  {{ "Customer's location data" | translate }}
                  <mat-icon
                    class="iconHelp"
                    matTooltip="{{
                      'Country, city, region and more information about the shipping location'
                        | translate
                    }}"
                    style="cursor: pointer"
                    data-id="63c0e48b"
                    >help
                  </mat-icon>
                </p>

                <mat-form-field appearance="outline" data-id="ddb5f2a1">
                  <mat-label data-id="42c40278">{{ 'Country' | translate }}</mat-label>
                  <mat-select
                    [compareWith]="compareById"
                    [formControl]="form.controls['CountryId']"
                    placeholder="{{ 'Country name' | translate }}"
                    required
                    type="text"
                    data-id="f3df3eec"
                  >
                    <mat-option
                      *ngFor="let country of allCountries"
                      [value]="country.id"
                      data-id="819c5456"
                    >
                      {{ utilsService.parserLanguage(country.name, language) }}
                    </mat-option>
                  </mat-select>
                  <mat-error
                    *ngIf="form.controls['CountryId'].hasError('required')"
                    data-id="39a4a96e"
                  >
                    {{ 'Country' | translate }}
                    <strong data-id="7f10c2a4">{{ 'is required' | translate }}</strong>
                  </mat-error>
                </mat-form-field>

                <div class="d-flex justify-content-between align-items-center" data-id="6b7b6ae2">
                  <mat-form-field
                    appearance="outline"
                    class="flex-sh-50 flex-sh-md-100"
                    data-id="294f7a36"
                  >
                    <mat-label data-id="064611b5">{{ 'City' | translate }}</mat-label>
                    <input
                      [formControl]="this.form.controls['city']"
                      matInput
                      placeholder="{{ 'City' | translate }}"
                      required
                      type="text"
                      data-id="ee8430ee"
                    />
                    <mat-error
                      *ngIf="form.controls['city'].hasError('required')"
                      data-id="3b8b2590"
                    >
                      {{ 'City' | translate }}
                      <strong data-id="c1cba4f3">{{ 'is required' | translate }}</strong>
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field
                    appearance="outline"
                    class="flex-sh-50 flex-sh-md-100"
                    data-id="f41f0756"
                  >
                    <mat-label data-id="e5e2a82b">{{
                      'State / Province / Region' | translate
                    }}</mat-label>
                    <input
                      [formControl]="this.form.controls['regionProvinceState']"
                      matInput
                      placeholder="{{ 'State / Province / Region' | translate }}"
                      required
                      type="text"
                      data-id="a4a6547d"
                    />
                    <mat-error
                      *ngIf="form.controls['regionProvinceState'].hasError('required')"
                      data-id="d3d6a93f"
                    >
                      {{ 'State / Province / Region' | translate }}
                      <strong data-id="8f4c8242">{{ 'is required' | translate }}</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </ng-container>

              <div formGroupName="address" *ngIf="canBeDelivery || showAddress" data-id="fd8a8fa3">
                <div class="d-flex transpilerClass-fxLayoutGap-844035" data-id="5e2d45fb">
                  <mat-form-field appearance="outline" class="flex-sh-80" data-id="8c2bcc64">
                    <mat-label data-id="0366db4f">{{ 'Calle' | translate }}</mat-label>
                    <input
                      formControlName="street"
                      matInput
                      placeholder="{{ 'Calle' | translate }}"
                      required
                      type="text"
                      data-id="6099801c"
                    />
                    <mat-error
                      *ngIf="this.form.controls['address']?.get('street')?.hasError('required')"
                      data-id="170d3a80"
                    >
                      {{ 'Calle' | translate }}
                      <strong data-id="bddf6f7c">{{ 'is required' | translate }}</strong>
                    </mat-error>
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="flex-sh-20" data-id="6fac15cb">
                    <mat-label data-id="d9f83117">{{ 'Número' | translate }}</mat-label>
                    <input
                      formControlName="number"
                      matInput
                      placeholder="{{ 'Número' | translate }}"
                      required
                      type="text"
                      data-id="4a6d6d44"
                    />
                    <mat-error
                      *ngIf="form.controls['address']?.get('number')?.hasError('required')"
                      data-id="ae6d370d"
                    >
                      {{ 'Número' | translate }}
                      <strong data-id="7ee39b92">{{ 'is required' | translate }}</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
                <mat-form-field appearance="outline" data-id="8b74ee71">
                  <mat-label data-id="c0c6e4fa">{{ 'Entre calles' | translate }}</mat-label>
                  <input
                    formControlName="between"
                    matInput
                    placeholder="{{ 'Entre calles' | translate }}"
                    required
                    type="text"
                    data-id="43e7c53d"
                  />
                  <mat-error
                    *ngIf="form.controls['address']?.get('between')?.hasError('required')"
                    data-id="d0d3ac40"
                  >
                    {{ 'Entre' | translate }}
                    <strong data-id="81018e74">{{ 'is required' | translate }}</strong>
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="d-flex justify-content-between align-items-center" data-id="a41bc5f2">
                <mat-form-field
                  appearance="outline"
                  id="CI"
                  class="flex-sh-100 flex-sh-md-50 flex-sh-50 flex-sh-md-initial"
                  data-id="e729eb17"
                >
                  <mat-label data-id="8c0f173d">{{ 'Identity card' | translate }}</mat-label>
                  <input
                    (keypress)="utilsService.keyPressAlphaAndNumbers($event)"
                    [formControl]="this.form.controls['dni']"
                    matInput
                    placeholder="{{ 'Identity card' | translate }}"
                    [required]="businessConfig.isDniRequired"
                    type="text"
                    data-id="885d24ae"
                  />
                  <mat-hint data-id="6673ea69">{{
                    'Asegúrese de escribirlo correctamente'
                  }}</mat-hint>
                  <mat-error *ngIf="form.controls['dni'].hasError('required')" data-id="79c2f1c0">
                    {{ 'Identity card' | translate }}
                    <strong data-id="69cafea7">{{ 'is required' | translate }}</strong>
                  </mat-error>
                  <mat-error *ngIf="form.controls['dni'].hasError('minlength')" data-id="99086170">
                    {{ 'Longitud mínima' | translate }}
                    <strong data-id="9623adde"
                      >{{ CI_Length }} {{ 'caracteres' | translate }}</strong
                    >
                  </mat-error>
                </mat-form-field>

                <div
                  class="w-100 d-flex flex-sh-50 flex-sh-md-100 transpilerClass-fxLayoutGap-6fa278"
                  data-id="b49f3377"
                >
                  <guajiritos-general-autocomplete
                    [withoutPaddingBottom]="false"
                    [label]="'Código'"
                    [valueId]="true"
                    [displayOptions]="callingCodeDisplayOptions"
                    [field]="['code']"
                    [filterString]="['filter[$and][code][$like]']"
                    [url]="phoneCodesService.url"
                    [formControl]="form.get('PhoneCallingCodeId')"
                    class="flex-sh-30"
                    data-id="8eb26cc5"
                  ></guajiritos-general-autocomplete>

                  <mat-form-field
                    appearance="outline"
                    id="phone"
                    class="flex-sh-70 flex-sh-md-70"
                    data-id="7d718e94"
                  >
                    <mat-label data-id="6b101b3a">{{ 'Teléfono celular' | translate }}</mat-label>
                    <!--                      <span class="mr-2" matPrefix>+ 53</span>-->
                    <input
                      (keypress)="utilsService.keyPressNumbers($event)"
                      [formControl]="form.get('phone')"
                      matInput
                      autocomplete="off"
                      placeholder="{{ 'Teléfono...' | translate }}"
                      data-id="565a5e99"
                    />
                    <mat-hint
                      *ngIf="form.get('phone').value && form.get('phone').valid"
                      data-id="7d0c2bc9"
                    >
                      {{ 'Número válido' | translate }}
                    </mat-hint>
                    <mat-error
                      *ngIf="
                        (form.controls['phone'].hasError('minlength') ||
                          form.controls['phone'].hasError('maxlength')) &&
                        !form.controls['phone'].hasError('pattern')
                      "
                      data-id="fdcbe051"
                    >
                      {{ 'Longitud del número' | translate }}&nbsp;<strong data-id="b56fb610">{{
                        '8 caracteres, Ex: 51234567' | translate
                      }}</strong>
                    </mat-error>
                  </mat-form-field>
                </div>

                <!--                <mat-form-field appearance="outline" fxFlex="100" fxFlex.gt-md="48" fxFlex.md="48" id="phone-checkout">-->
                <!--                  <mat-label>{{ 'Phone' | translate }}</mat-label>-->
                <!--                  <span class="mr-2" matPrefix>+ 53</span>-->
                <!--                  <input-->
                <!--                    (keypress)="utilsService.keyPressNumbers($event)"-->
                <!--                    [formControl]="this.form.controls['phone']"-->
                <!--                    matInput-->
                <!--                    placeholder="{{ 'Phone' | translate }}"-->
                <!--                    required-->
                <!--                  />-->
                <!--                  <mat-hint *ngIf="!form.get('phone').value">-->
                <!--                    {{ 'Escriba un teléfono móvil cubano, Ex: 51234567' | translate }}-->
                <!--                  </mat-hint>-->
                <!--                  <mat-hint *ngIf="form.get('phone').value && form.get('phone').valid">-->
                <!--                    {{ 'Número válido' | translate }}-->
                <!--                  </mat-hint>-->
                <!--                  <mat-error *ngIf="form.controls['phone'].hasError('required')">-->
                <!--                    {{ 'Phone' | translate }} <strong>{{ 'is required' | translate }}</strong>-->
                <!--                  </mat-error>-->
                <!--                  <mat-error-->
                <!--                    *ngIf="-->
                <!--                      (form.controls['phone'].hasError('minlength') || form.controls['phone'].hasError('maxlength')) &&-->
                <!--                      !form.controls['phone'].hasError('pattern')-->
                <!--                    "-->
                <!--                  >-->
                <!--                    {{ 'Longitud del número' | translate }}&nbsp;<strong>{{-->
                <!--                      '8 caracteres, Ex: 51234567' | translate-->
                <!--                    }}</strong>-->
                <!--                  </mat-error>-->
                <!--                  <mat-error *ngIf="form.controls['phone'].hasError('pattern')">-->
                <!--                    {{ 'El número' | translate }}&nbsp;<strong>{{-->
                <!--                      'debe empezar con 5, Ex: 51234567' | translate-->
                <!--                    }}</strong>-->
                <!--                  </mat-error>-->
                <!--                </mat-form-field>-->

                <!----------------CUSTOM FIELDS------------------>
                <ng-container *ngIf="customFields?.length > 0 && fields" data-id="54869278">
                  <p class="mat-body-2 my-2" style="text-transform: uppercase" data-id="0524fe71">
                    {{ 'Datos especiales' | translate }}
                    <mat-icon
                      class="iconHelp"
                      matTooltip="{{ 'Datos especiales que solicita el negocio.' | translate }}"
                      style="cursor: pointer"
                      data-id="d2affcd6"
                      >help
                    </mat-icon>
                  </p>

                  <ng-container *ngFor="let element of fields" data-id="94784e92">
                    <ng-container [ngSwitch]="element.type" data-id="422718ad">
                      <ng-container *ngSwitchCase="'DATE'" data-id="3ad1102e">
                        <mat-form-field
                          formGroupName="data"
                          appearance="outline"
                          data-id="f78688db"
                        >
                          <mat-label data-id="3db3c5d0">{{ element?.name }}</mat-label>
                          <input
                            matInput
                            [matDatepicker]="picker"
                            [min]="minDate"
                            formControlName="{{ element?.name }}"
                            data-id="5a029161"
                          />
                          <mat-datepicker-toggle
                            matSuffix
                            [for]="picker"
                            data-id="eb62d1ce"
                          ></mat-datepicker-toggle>
                          <mat-datepicker #picker data-id="8a17b69b"></mat-datepicker>
                          <mat-error
                            *ngIf="form.controls['data']?.get(element?.name)?.hasError('required')"
                            data-id="c3040c64"
                          >
                            {{ element?.name }}
                            <strong data-id="4fc0b1f2">{{ 'is required' | translate }}</strong>
                          </mat-error>
                        </mat-form-field>
                      </ng-container>
                      <ng-container *ngSwitchCase="'TIME'" data-id="00215ff9">
                        <mat-form-field
                          formGroupName="data"
                          appearance="outline"
                          class="time-icon-style"
                          data-id="4441e454"
                        >
                          <mat-label data-id="fb031794">{{ element?.name }}</mat-label>
                          <input
                            matInput
                            [ngxTimepicker]="toggleTimepicker"
                            [min]="minHour"
                            [max]="maxHour"
                            [format]="24"
                            formControlName="{{ element?.name }}"
                            readonly
                            data-id="af0407cb"
                          />
                          <ngx-material-timepicker-toggle
                            matSuffix
                            [for]="toggleTimepicker"
                            data-id="3e14b900"
                          ></ngx-material-timepicker-toggle>
                          <ngx-material-timepicker
                            #toggleTimepicker
                            [theme]="timePickerTheme"
                            data-id="4c183619"
                          ></ngx-material-timepicker>
                          <mat-error
                            *ngIf="form.controls['data']?.get(element?.name)?.hasError('required')"
                            data-id="72bd2bad"
                          >
                            {{ element?.name }}
                            <strong data-id="05e714fd">{{ 'is required' | translate }}</strong>
                          </mat-error>
                        </mat-form-field>
                      </ng-container>
                      <ng-container *ngSwitchDefault data-id="b349bf75">
                        <mat-form-field
                          formGroupName="data"
                          appearance="outline"
                          data-id="1d7995a4"
                        >
                          <mat-label data-id="520a95ac">{{ element?.name }}</mat-label>
                          <input
                            matInput
                            formControlName="{{ element?.name }}"
                            placeholder="{{ element?.name }}"
                            [required]="isRequiredField(element?.name)"
                            data-id="a5cad336"
                          />
                          <mat-error
                            *ngIf="form.controls['data']?.get(element?.name)?.hasError('required')"
                            data-id="5e9eb395"
                          >
                            {{ element?.name }}
                            <strong data-id="cfab97e4">{{ 'is required' | translate }}</strong>
                          </mat-error>
                          <mat-error
                            *ngIf="form.controls['data']?.get(element?.name)?.hasError('pattern')"
                            data-id="1d6c6fa3"
                          >
                            {{ element?.name }}
                            <strong data-id="b19a323a">{{ 'is invalid' | translate }}</strong>
                          </mat-error>
                        </mat-form-field>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </ng-container>
                <!------------------------------------------->
              </div>
            </div>

            <div class="add-info" data-id="b1a93572">
              <h3 class="grey-800" ngClass.gt-sm="h2" ngClass.xs="h4" data-id="96e4f7d7">
                {{ 'Aditional information' | translate }}
              </h3>
            </div>
            <div
              class="mt-1 flex-sh-100 flex-sh-100 flex-sh-sm-initial"
              ngClass.sm="mt-1"
              ngClass.xs="mt-1"
              data-id="0899382c"
            >
              <mat-form-field appearance="outline" class="w-100" data-id="7ae1a38f">
                <textarea
                  [formControl]="this.form.controls['info']"
                  matInput
                  placeholder="{{
                    'Some information about your address or something important' | translate
                  }}"
                  rows="2"
                  data-id="4a6a9c0c"
                ></textarea>
              </mat-form-field>
            </div>

            <div class="add-info mb-3 d-flex d-xs-none d-sm-none d-md-none" data-id="e039d188">
              <mat-checkbox [formControl]="form.get('checkAge')" class="d-flex" data-id="88e701ce">
                <span data-id="91a1d945"
                  >{{ 'Al registrarse en la tienda usted acepta nuestros' | translate }}
                  <!--                      <br>-->
                </span>
                <a [routerLink]="['/term-conditions']" data-id="59e29b50">
                  {{ 'términos y condiciones' | translate }}
                </a>
              </mat-checkbox>
            </div>

            <div
              class="add-info mb-3 d-flex d-xs-block d-sm-block d-md-block d-none"
              data-id="5413dd43"
            >
              <mat-checkbox [formControl]="form.get('checkAge')" class="d-flex" data-id="7c6d30b1">
                <span data-id="2163f8cb"
                  >{{ 'Al registrarse en la tienda usted acepta nuestros' | translate }}
                  <br data-id="e3d23f89" />
                </span>
                <a [routerLink]="['/term-conditions']" data-id="f61462d8">
                  {{ 'términos y condiciones' | translate }}
                </a>
              </mat-checkbox>
            </div>

            <h1 *ngIf="noGateway" class="tex-align-center p-4 color-red-500" data-id="cd607c87">
              {{ 'Este negocio no tiene método de pago permitido' }}
            </h1>

            <div
              class="actions-buttons d-flex justify-content-between align-items-start flex-sh-NaN"
              data-id="50261678"
            >
              <button mat-stroked-button matStepperPrevious data-id="43834729">
                {{ 'Atrás' | translate }}
              </button>
              <button
                id="buttonSecondStep"
                (click)="onGoToPayment()"
                [disabled]="noGateway || form.invalid"
                color="primary"
                mat-raised-button
                matStepperNext
                data-id="8a256e8e"
              >
                {{ 'Continuar' | translate }}
              </button>
            </div>
          </div>
        </mat-step>
        <mat-step data-id="5b988376">
          <ng-template matStepLabel data-id="9501bd5b">{{ 'Resumen' | translate }}</ng-template>
          <!-- =================================================================== -->
          <!-- PASARELA DE PAGO -->
          <!-- =================================================================== -->
          <div
            class="mainOrder-wrapper d-flex flex-column flex-sh-100 flex-sh-md-50 flex-sh-50 flex-sh-md-initial"
            data-id="d9d80bf9"
          >
            <div *ngIf="!loadingPayment" class="main-order" data-id="5af1f036">
              <div class="order-box" data-id="a304f29c">
                <ul *ngIf="buyProducts.length <= 0" class="quantity" data-id="e8bfd2b6">
                  <li class="empty-checkout" data-id="b85da294">
                    {{ 'There are no products in cart' | translate }}
                  </li>
                </ul>

                <ul *ngIf="!loadingCart && showShipping" class="total-amount" data-id="dfece26a">
                  <li data-id="0e231f04">
                    {{ 'Subtotal' | translate }}:
                    <span class="amount px-2" data-id="04f16f2e">{{
                      getTotalAmountCurrency() | currencyProduct: form.controls['currency'].value
                    }}</span>
                  </li>
                </ul>

                <!-- ============================================ -->
                <!-- DESCUENTO APLICADO -->
                <ul *ngIf="!loadingCart && showShipping" class="total-amount" data-id="315f39b7">
                  <li data-id="1f47d078">
                    {{ 'Descuento aplicado' | translate }}:
                    <!--                    <span style='font-size: 20px'></span>-->
                    <span class="amount px-2" data-id="07602eec">{{
                      cart.offerGiftDiscount.discountGift
                        | currencyProduct: form.controls['currency'].value
                    }}</span>
                  </li>
                </ul>

                <!-- ============================================ -->
                <!-- TARIFA DE ENVIO -->
                <ul *ngIf="showShipping" class="total" data-id="3ac1b353">
                  <li data-id="8b1a0384">
                    {{ 'Tarifa de envío' | translate }}:

                    <span class="count px-2" data-id="793a41ab">
                      {{
                        getShippingSelectedPrice()
                          | currencyProduct: form.controls['currency'].value
                      }}
                    </span>
                  </li>
                </ul>
                <div
                  *ngIf="!loadingCart"
                  class="mb-3 pb-3 d-flex flex-column justify-content-start align-items-start"
                  style="border-bottom: 1px solid #e5e5e5"
                  data-id="053f4924"
                >
                  <div
                    class="w-100 d-flex d-xs-flex d-sm-flex flex-xs-column flex-sm-column justify-content-between align-items-center justify-content-xs-start justify-content-sm-start"
                    ngClass.gt-xs="pt-1"
                    data-id="0e7be14f"
                  >
                    <div class="order-xs-2 order-sm-2" data-id="1c365e45">
                      <!-- ------------------------------------------------- -->
                      <!-- DESCRIPTION OF ADDRESS BUSINESS -->
                      <ng-container data-id="ec739212">
                        <!-- ============================================ -->
                        <ng-container
                          *ngIf="form.controls['paymentType'].value === 'bidaiondo'"
                          data-id="d6b2a0d1"
                        >
                          <p
                            class="mat-body-2 my-2"
                            style="text-transform: uppercase"
                            data-id="f55c7851"
                          >
                            {{ 'Información de Pago' | translate }}
                          </p>
                          <span class="mb-2" data-id="5a532dd7">{{
                            'Las compras realizadas en el sitio deben exceder el importe de 15.00. Si su compra no alcanza este mínimo, no podremos procesar su orden.'
                              | translate
                          }}</span>
                        </ng-container>

                        <!-- INFO DIRECCION DEL NEGOCIO -->
                        <div
                          *ngIf="!showShipping && buyProducts.length > 0 && hasPickUpPlace"
                          class="mb-3 d-flex flex-column"
                          data-id="15b9b780"
                        >
                          <p
                            class="mat-body-2 my-2"
                            style="text-transform: uppercase"
                            data-id="7016d918"
                          >
                            {{ 'Recogida' | translate }}
                          </p>
                          <span class="mb-2" data-id="cfb71701">{{
                            'Payment will be made at the Business office' | translate
                          }}</span>
                          <div
                            class="mb-1 font-weight-400"
                            style="color: #585858"
                            data-id="786f44e2"
                          >
                            {{ 'Negocio' | translate }}:
                            <span class="font-weight-600" data-id="36c2ad1a">{{
                              theBusiness?.name || '-'
                            }}</span>
                          </div>
                          <div
                            class="mb-1 font-weight-400"
                            style="color: #585858"
                            data-id="a9983bb4"
                          >
                            {{ 'Dirección' | translate }}:
                            <span class="font-weight-600" data-id="1c5cc756">{{
                              theBusiness?.address || '-'
                            }}</span>
                          </div>
                          <div
                            class="mb-1 font-weight-400"
                            style="color: #585858"
                            data-id="5fd3a3ea"
                          >
                            {{ 'Email' | translate }}:
                            <span class="font-weight-600" data-id="d7a471ee">{{
                              theBusiness?.email || '-'
                            }}</span>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>

                <!-- ======LOADING====== -->
                <ng-container *ngIf="loadingCart" data-id="75196b06">
                  <div
                    class="py-2 my-2 w-100 loader d-flex justify-content-start align-items-center"
                    style="border-radius: 4px"
                    data-id="260b9d1c"
                  ></div>
                  <div
                    class="py-2 my-2 w-100 loader d-flex justify-content-start align-items-center"
                    style="border-radius: 4px"
                    data-id="13ab339b"
                  ></div>
                  <div
                    class="py-2 my-2 w-100 loader d-flex justify-content-start align-items-center"
                    style="border-radius: 4px"
                    data-id="3825521a"
                  ></div>
                  <div
                    class="py-2 my-2 w-100 loader d-flex justify-content-start align-items-center"
                    style="border-radius: 4px"
                    data-id="a155a21c"
                  ></div>
                  <div
                    class="py-2 my-2 w-100 loader d-flex justify-content-start align-items-center"
                    style="border-radius: 4px"
                    data-id="a9577d95"
                  ></div>
                  <div
                    class="py-2 my-2 w-100 loader d-flex justify-content-start align-items-center"
                    style="border-radius: 4px"
                    data-id="11741f63"
                  ></div>
                </ng-container>

                <!-- DESCUENTO APLICADO -->
                <ul class="total-amount" *ngIf="!showShipping" data-id="c2a309e3">
                  <li data-id="508b1362">
                    {{ 'Descuento aplicado' | translate }}:
                    <!--                    <span></span>-->
                    <span class="amount px-2" data-id="210dcc93">{{
                      cart.offerGiftDiscount.discountGift
                        | currencyProduct: form.controls['currency'].value
                    }}</span>
                  </li>
                </ul>

                <!-- =====TOTAL=====-->
                <ul class="total" data-id="824a7de2">
                  <li data-id="f2b7dda0">
                    {{ 'Total' | translate }}
                    <span class="count px-2" data-id="1c26c49c">{{
                      getTotalWithShippingIncludedCurrency()
                        | currencyProduct: form.controls['currency'].value
                    }}</span>
                  </li>
                </ul>

                <div
                  class="w-100 d-flex justify-content-center align-items-stretch"
                  data-id="fb9da195"
                >
                  <a id="pasarelaLink" style="display: none" data-id="d34c2d59"></a>
                </div>
              </div>
            </div>

            <div
              *ngIf="!loadingPayment"
              class="actions-buttons d-flex justify-content-between align-items-start flex-sh-NaN"
              data-id="b4f8157b"
            >
              <!--              <button (click)="onGoToInfoDataToPay()" mat-stroked-button>{{ 'Atrás' | translate }}</button>-->
              <button matStepperPrevious mat-stroked-button data-id="69400c6f">
                {{ 'Atrás' | translate }}
              </button>
              <button
                (click)="onPayOrder()"
                [disabled]="
                  form.invalid ||
                  !buyProducts.length ||
                  (form.controls['paymentType'].value !== 'visa' &&
                    form.controls['paymentType'].value !== 'express' &&
                    form.controls['paymentType'].value !== 'masterCard' &&
                    form.controls['paymentType'].value !== 'dinners-club-internacional' &&
                    form.controls['paymentType'].value !== 'jcb' &&
                    form.controls['paymentType'].value !== 'maestro' &&
                    form.controls['paymentType'].value !== 'electron' &&
                    form.controls['paymentType'].value !== 'tarjeta-virtual' &&
                    form.controls['paymentType'].value !== 'bizum' &&
                    form.controls['paymentType'].value !== 'iupay' &&
                    form.controls['paymentType'].value !== 'discover-global' &&
                    form.controls['paymentType'].value !== 'peoplegoto' &&
                    form.controls['paymentType'].value !== 'paypal' &&
                    form.controls['paymentType'].value !== 'multisafepay' &&
                    form.controls['paymentType'].value !== 'tropipay' &&
                    form.controls['paymentType'].value !== 'enzona' &&
                    form.controls['paymentType'].value !== 'transfermovil')
                "
                color="primary"
                mat-raised-button
                data-id="286167ec"
              >
                {{ 'Pagar' | translate }}
              </button>
            </div>

            <div
              *ngIf="loadingPayment"
              class="loader"
              style="width: 100%; min-height: 500px; height: 100%"
              data-id="3975bb0b"
            ></div>
          </div>
        </mat-step>
      </mat-horizontal-stepper>
    </div>

    <!--    <div fxLayout="row wrap">-->
    <!--      &lt;!&ndash; ============================================================= &ndash;&gt;-->
    <!--      &lt;!&ndash; DATA INFO TO PAY &ndash;&gt;-->
    <!--      &lt;!&ndash; ============================================================= &ndash;&gt;-->
    <!--      <div-->
    <!--        *ngIf="showInfoDataToPay"-->
    <!--        class="billing-details"-->
    <!--        fxFlex="100"-->
    <!--        fxFlex.gt-md="50"-->
    <!--        fxFlex.md="50"-->
    <!--        ngClass.gt-sm="pr-5"-->
    <!--        ngClass.sm="pr-2"-->
    <!--        ngClass.xs="pr-0"-->
    <!--      >-->

    <!--        <div *ngIf="loadingPayment" class="loader" style="width: 100%; min-height: 500px; height: 100%"></div>-->
    <!--      </div>-->
    <!--    </div>-->
  </div>
</div>
